import{M as y,d as x}from"./DelModal-D896EmeM.js";import{_ as v,o as h,c as u,b as t,s as n,v as r,y as V,e as w,r as m,d as p,F as A,h as k,t as _}from"./index-DB9Op6xa.js";import"./component-functions-CeBV3bHd.js";var T={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:I,VITE_PATH:E}=T,D={props:["tempArticle","status"],data(){return{ArticleModal:"",editArticle:{tag:[""]}}},watch:{tempArticle(){this.editArticle=this.tempArticle}},methods:{updateArticle(){this.editArticle.create_at=new Date().getTime();const l=`${I}api/${E}/admin/article`,e={data:this.editArticle};this.status?this.$http.post(l,e).then(i=>{}).catch(i=>{console.log(i)}):this.$http.put(`${l}/${this.editArticle.id}`,e).then(i=>{}).catch(i=>{console.log(i)})},showModal(){this.articleModal.show()},hideModal(){this.articleModal.hide()}},mounted(){this.articleModal=new y(this.$refs.articleModal),this.editArticle=this.tempArticle}},P={class:"modal fade",id:"articleModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"articleModal"},U={class:"modal-dialog modal-xl",role:"document"},L={class:"modal-content"},C=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},"文章編輯"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),S={class:"modal-body"},F={class:"row"},R={class:"col-sm-4"},B={class:"mb-2"},H={class:"mb-3"},N=t("label",{for:"imageUrl",class:"form-label"},"輸入圖片網址",-1),O=["src"],z={class:"mb-3"},j=t("label",{for:"customFile",class:"form-label"},[w("或 上傳圖片 "),t("i",{class:"fas fa-spinner fa-spin"})],-1),q=t("div",null,[t("button",{class:"btn btn-outline-primary btn-sm d-block w-100"}," 新增圖片 ")],-1),G=t("div",null,[t("button",{class:"btn btn-outline-danger btn-sm d-block w-100 mt-2"}," 刪除圖片 ")],-1),J={class:"col-sm-8"},K={class:"mb-3"},Q=t("label",{for:"title",class:"form-label"},"標題",-1),W={class:"row"},X={class:"mb-3 col-md-6"},Y=t("label",{for:"category",class:"form-label"},"作者",-1),Z={class:"mb-3 col-md-6"},tt=t("label",{for:"price",class:"form-label"},"標籤",-1),et=t("hr",null,null,-1),lt={class:"mb-3"},st=t("label",{for:"description",class:"form-label"},"文章內容",-1),ot={class:"mb-3"},it=t("label",{for:"content",class:"form-label"},"說明內容",-1),at={class:"mb-3"},dt={class:"form-check"},ct=t("label",{class:"form-check-label",for:"is_enabled"},"是否公開",-1),nt={class:"modal-footer"},rt=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function ht(l,e,i,a,s,d){return h(),u("div",P,[t("div",U,[t("div",L,[C,t("div",S,[t("div",F,[t("div",R,[t("div",B,[t("div",H,[N,n(t("input",{type:"text",class:"form-control",placeholder:"請輸入圖片連結","onUpdate:modelValue":e[0]||(e[0]=o=>s.editArticle.image=o)},null,512),[[r,s.editArticle.image]])]),t("img",{class:"img-fluid",src:s.editArticle.image,alt:""},null,8,O)]),t("div",z,[j,t("input",{type:"file",id:"customFile",class:"form-control",ref:"fileInput",onChange:e[1]||(e[1]=(...o)=>l.uploadFile&&l.uploadFile(...o))},null,544)]),q,G]),t("div",J,[t("div",K,[Q,n(t("input",{id:"title",type:"text",class:"form-control",placeholder:"請輸入標題","onUpdate:modelValue":e[2]||(e[2]=o=>s.editArticle.title=o)},null,512),[[r,s.editArticle.title]])]),t("div",W,[t("div",X,[Y,n(t("input",{id:"category",type:"text",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=o=>s.editArticle.author=o),placeholder:"請輸入作者"},null,512),[[r,s.editArticle.author]])]),t("div",Z,[tt,n(t("input",{id:"unit",type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=o=>s.editArticle.tag=o),placeholder:"請輸入標籤"},null,512),[[r,s.editArticle.tag]])])]),et,t("div",lt,[st,n(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=o=>s.editArticle.description=o),placeholder:"請輸入文章內容"},`\r
                `,512),[[r,s.editArticle.description]])]),t("div",ot,[it,n(t("textarea",{id:"description",type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=o=>s.editArticle.content=o),placeholder:"請輸入說明內容"},`\r
                `,512),[[r,s.editArticle.content]])]),t("div",at,[t("div",dt,[n(t("input",{id:"is_enabled",class:"form-check-input",type:"checkbox","true-value":!0,"false-value":!1,"onUpdate:modelValue":e[7]||(e[7]=o=>s.editArticle.isPublic=o)},null,512),[[V,s.editArticle.isPublic]]),ct])])])])]),t("div",nt,[rt,t("button",{type:"button",class:"btn btn-primary",onClick:e[8]||(e[8]=(...o)=>d.updateArticle&&d.updateArticle(...o))}," 確認 ")])])])],512)}const ut=v(D,[["render",ht]]);var mt={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:b,VITE_PATH:f}=mt,pt={components:{delModal:x,ArticleModal:ut},data(){return{articles:[],article:{},isNew:!1,isLoading:!1}},mounted(){const l=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=l,this.getArticles()},methods:{getArticles(){this.isLoading=!0,this.$http.get(`${b}api/${f}/admin/articles`).then(l=>{this.articles=l.data.articles,this.isLoading=!1}).catch(l=>{console.log(l)})},updateArticle(l){this.editArticle.create_at=new Date().getTime();const e=`${b}api/${f}/admin/article`,i={data:l};this.isNew?this.$http.post(e,i).then(a=>{this.$refs.ArticleModal.hideModal(),alert(a.data.message),this.getArticles()}).catch(a=>{console.log(a)}):this.$http.put(`${e}/${this.editArticle.id}`,i).then(a=>{this.$refs.ArticleModal.hideModal(),this.getArticles()}).catch(a=>{console.log(a)})},delArticle(){const l=`${b}api/${f}/admin/article/${this.article.id}`;this.$http.delete(l).then(e=>{this.$refs.delModal.hideModal(),this.getArticles()})},openDelModal(l){this.article={...l},this.$refs.delModal.showModal()},openModal(l,e){l?this.article={}:this.article={...e},this.isNew=l,this.$refs.ArticleModal.showModal()},hideModal(){this.$refs.ArticleModal.hideModal()}}},_t={class:"container-fluid"},bt={class:"text-end me-3 mt-4"},ft={class:"table mt-4 mx-auto"},At=t("thead",null,[t("tr",null,[t("th",{width:"120"},"文章標題"),t("th",{width:"120"},"作者"),t("th",{width:"120"},"建立日期"),t("th",{width:"100"},"是否啟用"),t("th",{width:"200"},"編輯")])],-1),vt={class:"text-right"},Mt={key:0,class:"text-success"},gt={key:1,class:"text-muted"},$t={class:"btn-group"},yt=["onClick"],xt=["onClick"];function Vt(l,e,i,a,s,d){const o=m("LoadingView"),M=m("delModal"),g=m("ArticleModal");return h(),u(A,null,[p(o,{active:s.isLoading},null,8,["active"]),t("div",_t,[t("div",bt,[t("button",{class:"btn btn-primary",type:"button",onClick:e[0]||(e[0]=c=>d.openModal(!0))},"新增文章")]),t("table",ft,[At,t("tbody",null,[(h(!0),u(A,null,k(s.articles,c=>(h(),u("tr",{key:c.id},[t("td",null,_(c.title),1),t("td",null,_(c.author),1),t("td",vt,_(c.create_at),1),t("td",null,[c.isPublic===!0?(h(),u("span",Mt,"啟用")):(h(),u("span",gt,"未啟用"))]),t("td",null,[t("div",$t,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:$=>d.openModal(!1,c)},"編輯",8,yt),t("button",{class:"btn btn-outline-danger btn-sm",onClick:$=>d.openDelModal(c)},"刪除",8,xt)])])]))),128))])])]),p(M,{ref:"delModal",item:s.article,onDelItem:d.delArticle},null,8,["item","onDelItem"]),p(g,{ref:"ArticleModal",tempArticle:s.article,onUpdateArticle:d.updateArticle},null,8,["tempArticle","onUpdateArticle"])],64)}const It=v(pt,[["render",Vt]]);export{It as default};
