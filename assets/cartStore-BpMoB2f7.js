import{u as h,q as e}from"./index-Bp_NOMjC.js";var c={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:r,VITE_PATH:o}=c,u=h("cartStore",{state:()=>({carts:[],final_total:0,total:0,cart:{},status:{addCartLoading:""},cartUpdated:!1,isAreaLoading:!1,isLoading:!1}),actions:{addCart(t,a,i=1){this.status.addCartLoading=t,this.cart=a;const s=`${r}/api/${o}/cart`,n={data:{product_id:t,qty:i}};e.post(s,n).then(d=>{this.status.addCartLoading="",this.cart=d.data.data,this.cartUpdated=!0}).catch(d=>{alert(d)})},async delCart(t){const{VITE_API:a,VITE_PATH:i}=c;try{this.carts.length>1&&(this.isAreaLoading=!0),await e.delete(`${a}api/${i}/cart/${t}`).catch(()=>{alert("刪除失敗")}),this.getCarts(),await new Promise(s=>setTimeout(s,300)),this.isAreaLoading=!1}catch(s){alert(s),this.isAreaLoading=!1}},async getCarts(){(!this.isAreaLoading||this.carts.length===0)&&(this.isLoading=!0);try{const t=`${r}/api/${o}/cart`;await e.get(t).then(a=>{this.carts=a.data.data.carts,this.final_total=a.data.data.final_total,this.total=a.data.data.total}).catch(a=>{alert(a)}),await new Promise(a=>setTimeout(a,300)),this.isLoading=!1}catch(t){alert(t),this.isLoading=!1}},setCartUpdate(){this.cartUpdated=!1,this.getCarts()},getProduct(){const{id:t}=this.$route.params;this.$http.get(`${r}api/${o}/product/${t}`).then(a=>{this.product=a.data.product,this.matchCategory()}).catch(a=>{alert(a)})},async putCart(t,a){try{this.isAreaLoading=!0;const i={data:{product_id:t,qty:a}};await e.put(`${r}api/${o}/cart/${t}`,i),this.getCarts(),await new Promise(s=>setTimeout(s,300)),this.isAreaLoading=!1}catch{this.isAreaLoading=!1}},setIsLoading(t){this.isLoading=t}},getters:{cartData:({carts:t})=>t,cartTotal:({total:t})=>t}});export{u as c};
