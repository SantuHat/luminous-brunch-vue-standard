import{_ as S,m as y,u as C,a as x,L as D,r as i,o as t,c as n,b as s,d as a,n as d,f as o,t as E,e as p,g as h,w as b,F as O}from"./index-DmcKR0ch.js";import{o as g}from"./orderStore-IXJ17yG-.js";import{c as k}from"./cartStore-DcDdk7tf.js";import{U as R}from"./UserCartEmptyData-CXjx3hct.js";import{M as A}from"./MealList-C_LqzkgT.js";var U={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:M,VITE_PATH:F}=U,P={data(){return{totalPrice:0,step:1,userData:{data:{user:{name:"",email:"",tel:"",address:"高雄市"}}},orderId:"",orderTotal:0}},methods:{...y(g,["getOrders","getOrderItem"]),...y(k,["getCarts","setIsLoading"]),scrollTo(){window.scrollTo(0,0)},nextStep(l){this.setIsLoading(!0),this.step=l,window.scrollTo(0,0),setTimeout(()=>{this.setIsLoading(!1)},500)},postOrder(){const l=`${M}/api/${F}/order`;C.post(l,this.userData).then(r=>{this.orderId=r.data.orderId,this.orderTotal=r.data.total,this.getCarts(),this.getOrderItem(this.orderId)}).catch(r=>{alert(r)})},handleOrderSubmit(){this.nextStep(3),this.postOrder()}},computed:{...x(g,["userOrders","orderItem","orderTotal"]),...x(k,["carts","final_total","isAreaLoading","isLoading"])},mounted(){this.getOrders(),this.getCarts()},components:{LoadingSpinner:D,UserCartEmptyData:R,MealList:A}},B={class:"container mb-11"},N={class:"step-indicator mx-auto mt-5 font-sans-serif"},q=s("div",{class:"step active",id:"step1"},[s("span",null,"確認訂單")],-1),j=s("div",{class:"line"},null,-1),H=s("span",null,"填寫資料",-1),z=[H],G=s("div",{class:"line"},null,-1),J=s("span",null,"完成訂單",-1),K=[J],Q={key:0,class:"frame col-11 col-md-7 col-lg-5 mx-auto mb-7"},W={key:0,class:"text-center mb-7 mt-5 orderResult fw-bold"},X={key:1,class:"text-center mb-7 orderResult fw-bold"},Y={key:2,class:"text-center mb-7 fw-bold text-gray-300 orderNum"},Z={key:1,class:"mb-3 mt-3 text-center text-gray-400 orderResult font-sans-serif fw-bold"},$={key:2,class:"container mt-5 mb-9"},ee={key:3,class:"container mt-5 mb-9"},se={class:"area-loading"},te={key:0,class:"area-loading-wrap"},oe={key:0,class:"mb-5 mt-10 text-center text-gray-400 orderResult font-sans-serif fw-bold"},re={key:0,class:"text-danger me-1 align-middle"},ne={class:"col-11 col-md-4 mx-auto"},le=s("option",{value:"",selected:""},"請選擇",-1),ae=s("option",{value:"到店取餐付款"},"到店取餐付款",-1),ie=s("option",{value:"信用卡"},"信用卡",-1),de={key:0,class:"mb-5 mt-10 text-center text-gray-400 orderResult font-sans-serif fw-bold"},ce={class:"container"},me={class:"row order-data d-flex align-items-center font-sans-serif",style:{"flex-direction":"column"}},pe={class:"col-md-4 mb-2"},ue={for:"name",class:"sr-only text-primary py-3"},_e={key:0,class:"text-danger me-1 align-middle"},fe={class:"col-md-4 mb-2"},he={for:"orderTel",class:"sr-only text-primary py-3"},be={key:0,class:"text-danger me-1 align-middle"},ve={class:"col-md-4 mb-4"},ye={for:"orderEmail",class:"sr-only text-primary py-3"},xe={key:0,class:"text-danger me-1 align-middle"},ge=s("span",{class:"font-sans-serif"},null,-1),ke={key:0,class:"btn-box d-flex"},Ve=s("span",{class:"font-sans-serif"},"上一步",-1),Le=[Ve],we=s("button",{class:"btn_reserve py-3 px-6 py-md-4 px-md-11 mx-auto mt-10 mb-8"},[s("span",{class:"font-sans-serif"},"送出訂單")],-1),Ie=s("span",{class:"font-sans-serif"},"下一步",-1),Te=[Ie],Se={class:"d-flex"};function Ce(l,r,De,Ee,e,u){const V=i("LoadingView"),L=i("UserCartEmptyData"),w=i("LoadingSpinner"),I=i("MealList"),_=i("VField"),f=i("ErrorMessage"),T=i("VForm"),v=i("RouterLink");return t(),n(O,null,[s("div",B,[a(V,{active:l.isLoading},null,8,["active"]),s("div",N,[q,j,s("div",{class:d(["step",{active:e.step===2||e.step===3}]),id:"step2"},z,2),G,s("div",{class:d(["step",{active:e.step===3}]),id:"step3"},K,2)])]),e.step===3?(t(),n("div",Q,[e.step===3?(t(),n("h2",W,"感謝您的訂餐")):o("",!0),e.step===3?(t(),n("h2",X,"此筆訂單已成立!")):o("",!0),e.step===3?(t(),n("h3",Y,"訂單編號: "+E(e.orderId),1)):o("",!0)])):o("",!0),e.step===2||e.step===3?(t(),n("h3",Z,"訂餐明細")):o("",!0),l.carts.length===0&&e.step===1?(t(),n("div",$,[a(L)])):(t(),n("div",ee,[s("div",se,[l.isAreaLoading?(t(),n("div",te,[a(w,{scale:.5})])):o("",!0),a(I,{class:d({invisible:l.isAreaLoading}),step:e.step,list:e.step===3?l.orderItem:l.carts,total:e.step===3?e.orderTotal:l.final_total},null,8,["class","step","list","total"])]),e.step===2||e.step===3?(t(),n("h3",oe,[e.step===2?(t(),n("span",re,"*")):o("",!0),p("付款方式")])):o("",!0),e.step===2||e.step===3?(t(),h(T,{key:1,onSubmit:r[4]||(r[4]=c=>u.handleOrderSubmit())},{default:b(({errors:c})=>[s("div",ne,[e.step===2||e.step===3?(t(),h(_,{key:0,name:"付款方式",id:"付款方式",class:d(["bg-transparent p-2 form-control d-block rounded text-center font-sans-serif",{"is-invalid":c.付款方式,"cursor-pointer":e.step===2}]),disabled:e.step===3,rules:"required",as:"select"},{default:b(()=>[le,ae,ie]),_:2},1032,["disabled","class"])):o("",!0),a(f,{name:"付款方式",class:"invalid-feedback"})]),e.step===2||e.step===3?(t(),n("h3",de,"訂餐人資料")):o("",!0),s("div",ce,[s("div",me,[s("div",pe,[s("label",ue,[e.step===2?(t(),n("span",_e,"*")):o("",!0),p("姓名")]),a(_,{type:"text",id:"name",name:"姓名",class:d(["form-control w-100",{"is-invalid":c.姓名}]),placeholder:"請輸入姓名",rules:"required",autofocus:"",modelValue:e.userData.data.user.name,"onUpdate:modelValue":r[0]||(r[0]=m=>e.userData.data.user.name=m),disabled:e.step===3},null,8,["class","modelValue","disabled"]),a(f,{name:"姓名",class:"invalid-feedback"})]),s("div",fe,[s("label",he,[e.step===2?(t(),n("span",be,"*")):o("",!0),p("電話")]),a(_,{type:"text",id:"orderTel",name:"電話",class:d(["form-control",{"is-invalid":c.電話}]),placeholder:"請輸入電話",rules:"required|numeric|min:10|max:10",autofocus:"",modelValue:e.userData.data.user.tel,"onUpdate:modelValue":r[1]||(r[1]=m=>e.userData.data.user.tel=m),disabled:e.step===3},null,8,["class","modelValue","disabled"]),a(f,{name:"電話",class:"invalid-feedback"})]),s("div",ve,[s("label",ye,[e.step===2?(t(),n("span",xe,"*")):o("",!0),ge,p("信箱")]),a(_,{type:"email",name:"email",id:"email",class:d(["form-control",{"is-invalid":c.email}]),placeholder:"abc@gmail.com",rules:"email|required",autofocus:"",modelValue:e.userData.data.user.email,"onUpdate:modelValue":r[2]||(r[2]=m=>e.userData.data.user.email=m),disabled:e.step===3},null,8,["class","modelValue","disabled"]),a(f,{name:"email",class:"invalid-feedback"})])]),e.step===2?(t(),n("div",ke,[s("a",{href:"javascript:;",class:"btn_reserve py-3 px-6 py-md-4 px-md-11 mx-auto mt-10 mb-8",onClick:r[3]||(r[3]=m=>u.nextStep(1))},Le),we])):o("",!0)])]),_:1})):o("",!0),e.step===1?(t(),n("a",{key:2,href:"javascript:;",class:"btn_reserve py-3 px-9 py-md-4 px-md-11 mx-auto mt-10 mb-8",onClick:r[5]||(r[5]=c=>u.nextStep(2))},Te)):o("",!0),s("div",Se,[e.step===3?(t(),h(v,{key:0,onClick:u.scrollTo,to:"/menuview/menulist?category=salad",class:"btn_reserve py-3 px-5 py-md-4 px-md-11 mx-auto mt-10 mb-8"},{default:b(()=>[p("繼續購物")]),_:1},8,["onClick"])):o("",!0),e.step===3?(t(),h(v,{key:1,to:"/userorders",class:"btn_reserve py-3 px-5 py-md-4 px-md-11 mx-auto mt-10 mb-8"},{default:b(()=>[p("查看我的所有訂單")]),_:1})):o("",!0)])]))],64)}const Fe=S(P,[["render",Ce]]);export{Fe as default};
