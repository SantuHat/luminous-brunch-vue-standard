import{M as $,d as x}from"./DelModal-DIraEYpI.js";import{_ as M,o as d,c as l,b as t,t as o,f as b,F as p,q as m,r as u,d as _,v as P,A as V}from"./index-DHhKwbeo.js";import{P as C}from"./PaginationView-1_ggznLL.js";import"./component-functions-ScLx8kQY.js";import"./scrollbar-BNNtefqr.js";const D={props:{order:{type:Object,default(){return{}}}},data(){return{tempOrder:{},myModal:"",isPaid:!1}},watch:{order(){this.tempOrder=this.order,this.isPaid=this.tempOrder.is_paid}},methods:{showModal(){this.myModal.show()},hideModal(){this.myModal.hide()}},mounted(){this.myModal=new $(this.$refs.orderModal)}},E={class:"modal fade",id:"orderstModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"orderModal"},L={class:"modal-dialog modal-xl",role:"document"},I={class:"modal-content border-0"},A=t("div",{class:"modal-header bg-dark text-white"},[t("h5",{class:"modal-title",id:"exampleModalLabel"},[t("span",null,"訂單細節")]),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),T={class:"modal-body"},U={class:"row"},B={class:"col-md-4"},N=t("h3",null,"用戶資料",-1),S={class:"table"},q={key:0},R=t("th",{style:{width:"100px"}},"姓名",-1),F=t("th",null,"Email",-1),H=t("th",null,"電話",-1),j=t("th",null,"地址",-1),z={class:"col-md-8"},G=t("h3",null,"訂單細節",-1),J={class:"table"},K=t("th",{style:{width:"100px"}},"訂單編號",-1),Q=t("th",null,"下單時間",-1),W=t("th",null,"付款時間",-1),X={key:0},Y=t("span",null,"時間不正確",-1),Z=t("th",null,"付款狀態",-1),tt={key:0,class:"text-success"},et={key:1,class:"text-muted"},ot=t("th",null,"總金額",-1),st=t("h3",null,"選購商品",-1),dt={class:"table"},lt=t("thead",null,[t("tr")],-1),nt={class:"text-end"},rt={class:"modal-footer"},at=t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"},"取消 ",-1);function it(s,r,h,y,e,c){return d(),l("div",E,[t("div",L,[t("div",I,[A,t("div",T,[t("div",U,[t("div",B,[N,t("table",S,[e.tempOrder.user?(d(),l("tbody",q,[t("tr",null,[R,t("td",null,o(e.tempOrder.user.name),1)]),t("tr",null,[F,t("td",null,o(e.tempOrder.user.email),1)]),t("tr",null,[H,t("td",null,o(e.tempOrder.user.tel),1)]),t("tr",null,[j,t("td",null,o(e.tempOrder.user.address),1)])])):b("",!0)])]),t("div",z,[G,t("table",J,[t("tbody",null,[t("tr",null,[K,t("td",null,o(e.tempOrder.id),1)]),t("tr",null,[Q,t("td",null,o(s.$filters.date(e.tempOrder.create_at)),1)]),t("tr",null,[W,t("td",null,[e.tempOrder.paid_date?(d(),l("span",X,o(e.tempOrder.paid_date),1)):b("",!0),Y])]),t("tr",null,[Z,t("td",null,[e.tempOrder.is_paid?(d(),l("strong",tt,"已付款")):(d(),l("span",et,"尚未付款"))])]),t("tr",null,[ot,t("td",null,o(e.tempOrder.total),1)])])]),st,t("table",dt,[lt,t("tbody",null,[(d(!0),l(p,null,m(e.tempOrder.products,a=>(d(),l("tr",{key:a.id},[t("th",null,o(a.product.title),1),t("td",null,o(a.qty)+" / "+o(a.product.unit),1),t("td",nt,o(a.final_total),1)]))),128))])])])])]),t("div",rt,[at,t("button",{type:"button",class:"btn btn-primary",onClick:r[0]||(r[0]=a=>s.$emit("update-order"))},"確認")])])])],512)}const ct=M(D,[["render",it]]);var ht={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:O,VITE_PATH:f}=ht,ut={data(){return{orders:[],orderPage:{},tempOrder:{},isNew:!1,isLoading:!1}},components:{DelModal:x,OrderModal:ct,PaginationView:C},methods:{getOrder(s){const r=`${O}/api/${f}/admin/orders?page=${s}`;this.isLoading=!0,this.$http.get(r).then(h=>{this.isLoading=!1,this.orders=h.data.orders,this.orderPage=h.data.pagination})},closureModal(){this.$refs.OrderModal.hideModal()},openOrder(s){this.tempOrder={...s},this.$refs.OrderModal.showModal()},openDelModal(s){this.tempOrder={...s},this.$refs.delModal.showModal()},dleOrder(){const s=this.$refs.delModal,r=`${O}/api/${f}/admin/order/${this.tempOrder.id}`;this.$http.delete(r).then(()=>{this.getOrder(),s.hideModal()})}},mounted(){const s=document.cookie.replace(/(?:(?:^|.*;\s*)hexToken\s*=\s*([^;]*).*$)|^.*$/,"$1");this.$http.defaults.headers.common.Authorization=s,this.getOrder()}},_t={class:"container-fluid"},pt={class:"table mt-4"},mt=t("thead",null,[t("tr",null,[t("th",{width:"120"},"購買時間"),t("th",{width:"120"},"Email"),t("th",{width:"120"},"購買品項"),t("th",{width:"120"},"應付金額"),t("th",{width:"100"},"是否付款"),t("th",{width:"200"},"檢視")])],-1),bt={class:"list-unstyled"},Ot={class:"text-right"},ft={class:"form-check form-switch"},Mt={class:"form-check-label",for:"#"},yt=["onUpdate:modelValue"],gt={key:0,calss:"text-success"},vt={key:1,class:"text-muted"},kt={class:"btn-group"},wt=["onClick"],$t=["onClick"];function xt(s,r,h,y,e,c){const a=u("LoadingView"),g=u("OrderModal"),v=u("DelModal"),k=u("PaginationView");return d(),l(p,null,[_(a,{active:e.isLoading},null,8,["active"]),t("div",_t,[t("table",pt,[mt,t("tbody",null,[(d(!0),l(p,null,m(e.orders,n=>(d(),l("tr",{key:n.id},[t("td",null,o(s.$filters.date(n.create_at)),1),t("td",null,o(n.user.email),1),t("td",null,[t("ul",bt,[(d(!0),l(p,null,m(n.products,(i,w)=>(d(),l("li",{key:w},o(i.product.title)+" 數量："+o(i.qty)+" "+o(i.product.unit),1))),128))])]),t("td",Ot,o(n.total),1),t("td",null,[t("div",ft,[t("label",Mt,[P(t("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":i=>n.is_paid=i},null,8,yt),[[V,n.is_paid]]),n.is_paid?(d(),l("span",gt,"已付款")):(d(),l("span",vt,"未付款"))])])]),t("td",null,[t("div",kt,[t("button",{class:"btn btn-outline-primary btn-sm",onClick:i=>c.openOrder(n)},"檢視",8,wt),t("button",{class:"btn btn-outline-danger btn-sm",onClick:i=>c.openDelModal(n)},"刪除",8,$t)])])]))),128))])])]),_(g,{order:e.tempOrder,ref:"OrderModal",onUpdateOrder:c.closureModal},null,8,["order","onUpdateOrder"]),_(v,{item:e.tempOrder,ref:"delModal",onDelItem:c.dleOrder},null,8,["item","onDelItem"]),_(k,{pagination:e.orderPage,onEmitPages:c.getOrder},null,8,["pagination","onEmitPages"])],64)}const Lt=M(ut,[["render",xt]]);export{Lt as default};
