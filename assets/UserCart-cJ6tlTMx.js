import{_ as I,m as g,k as S,a as m,r as x,o,c as l,b as t,d as V,n as i,l as r,t as a,F as _,g as k,q as h,v as y,s as v,w as f,e as p}from"./index-_e0xypRU.js";import{o as C}from"./orderStore-dr7uW6kf.js";import{c as w}from"./cartStore-3O4pVfKf.js";var q={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:D,VITE_PATH:O}=q,N={data(){return{totalPrice:0,step:1,isLoading:!1,userData:{data:{user:{name:"",email:"",tel:"",address:"高雄市"}}},orderId:"",orderTotal:0}},methods:{...g(C,["getOrders","getOrderItem"]),...g(w,["getCarts","delCart","putCart"]),scrollTo(){window.scrollTo(0,0)},nextStep(c){this.step=c,window.scrollTo(0,0)},postOrder(){const c=`${D}/api/${O}/order`;S.post(c,this.userData).then(n=>{console.log(n),this.orderId=n.data.orderId,this.orderTotal=n.data.total,this.getCarts(),this.getOrderItem(this.orderId)}).catch(n=>{console.log(n)})},handleOrderSubmit(){this.nextStep(3),this.postOrder()}},computed:{...m(C,["userOrders","orderItem"]),...m(w,["carts","final_total"])},mounted(){this.getOrders(),this.getCarts()}},U={class:"container mb-11"},E={class:"step-indicator mx-auto mt-5"},L=t("div",{class:"step active",id:"step1"},[t("span",{class:"fs-4"},"確認訂單")],-1),A=t("div",{class:"line"},null,-1),P=t("span",{class:"fs-4"},"填寫資料",-1),j=[P],B=t("div",{class:"line"},null,-1),R=t("span",{class:"fs-4"},"完成訂單",-1),F=[R],H={key:0,class:"text-center mb-7"},M={key:1,class:"text-center mb-7"},z={key:2,class:"mb-3 mt-12 text-center text-gray-400 font-NotoSerif"},G={class:"container mt-5 mb-9"},J={key:0,class:"border border-gray box-shadow-gray-300 mx-auto w-100"},K=t("thead",{class:"bg-gray text-center"},[t("tr",null,[t("th",{class:"px-lg-6 py-lg-4",colspan:"2"},"商品"),t("th",{class:"px-lg-6 py-lg-4"},"單價"),t("th",{class:"px-lg-6 py-lg-4"},"數量"),t("th",{class:"px-lg-6 py-lg-4"},"小計"),t("th",{class:"px-lg-6 py-lg-4"}),t("th",{class:"px-lg-6 py-lg-4"},"總金額")])],-1),Q={class:"position-relative"},W={class:"position-absolute js-tbody"},X={width:"12%"},Y=["src","alt"],Z={class:"text-center"},$={class:"text-center"},tt=["onClick","disabled"],st=["onClick"],et={class:"text-center"},ot=["onClick"],lt=t("span",{class:"material-symbols-outlined pt-1"}," delete ",-1),rt=[lt],nt={key:1,class:"border border-gray box-shadow-gray-300 mx-auto w-100"},ct=t("thead",{class:"bg-gray text-center"},[t("tr",null,[t("th",{class:"px-lg-6 py-lg-4",colspan:"2"},"商品"),t("th",{class:"px-lg-6 py-lg-4"},"單價"),t("th",{class:"px-lg-6 py-lg-4"},"數量"),t("th",{class:"px-lg-6 py-lg-4"},"小計"),t("th",{class:"px-lg-6 py-lg-4"}),t("th",{class:"px-lg-6 py-lg-4"},"總金額")])],-1),at={class:"position-relative"},dt={class:"position-absolute js-tbody"},it={width:"12%"},pt=["src","alt"],ut={class:"text-center"},_t={class:"text-center"},ht=["onClick","disabled"],yt=["onClick"],bt={class:"text-center"},gt=["onClick"],mt=t("span",{class:"material-symbols-outlined pt-1"}," delete ",-1),xt=[mt],kt={key:2,class:"mb-7 mt-10 text-center text-gray-400 font-NotoSerif"},vt={key:3,class:"border border-gray box-shadow-gray-300 mx-auto w-100"},ft=t("thead",{class:"bg-gray text-center"},[t("tr",null,[t("th",{class:"px-lg-6 py-lg-4"},"姓名"),t("th",{class:"px-lg-6 py-lg-4"},"手機號碼"),t("th",{class:"px-lg-6 py-lg-4"},"信箱")])],-1),Ct={class:"js-tbody"},wt={class:"text-center p-5"},Tt=["disabled"],It={class:"text-center p-5"},St=["disabled"],Vt={class:"text-center p-5"},qt=["disabled"],Dt={key:4,class:"mb-5 mt-10 text-center text-gray-400 font-NotoSerif"},Ot=["disabled"],Nt=t("option",{value:"請選擇"},"請選擇",-1),Ut=t("option",{value:"到店取餐付款"},"到店取餐付款",-1),Et=t("option",{value:"信用卡"},"信用卡",-1),Lt=[Nt,Ut,Et],At={class:"d-flex"};function Pt(c,n,jt,Bt,s,u){const T=x("LoadingView"),b=x("RouterLink");return o(),l(_,null,[t("div",U,[V(T,{active:s.isLoading},null,8,["active"]),t("div",E,[L,A,t("div",{class:i(["step",{active:s.step===2||s.step===3}]),id:"step2"},j,2),B,t("div",{class:i(["step",{active:s.step===3}]),id:"step3"},F,2)])]),s.step===3?(o(),l("h2",H,"感謝您的訂餐，此筆訂單已成立!")):r("",!0),s.step===3?(o(),l("h3",M,"訂單編號: "+a(s.orderId),1)):r("",!0),s.step===2||s.step===3?(o(),l("h3",z,"訂餐明細")):r("",!0),t("div",G,[s.step===1||s.step===2?(o(),l("table",J,[K,t("tbody",Q,[t("div",W,"NT$ "+a(c.final_total),1),(o(!0),l(_,null,k(c.carts,e=>(o(),l("tr",{key:e.product_id},[t("th",X,[t("img",{src:e.product.imageUrl,class:"me-2 toast-img",alt:e.product.imageUrl},null,8,Y)]),t("th",null,a(e.product.title),1),t("th",Z,a(e.product.price),1),t("th",$,[s.step===1?(o(),l("button",{key:0,onClick:d=>{e.qty--,c.putCart(e.id,e.qty)},class:"btn fw-bold",type:"button",disabled:e.qty===1},"–",8,tt)):r("",!0),p(" "+a(e.qty)+" ",1),s.step===1?(o(),l("button",{key:1,onClick:d=>{e.qty++,c.putCart(e.id,e.qty)},class:"btn fw-bold",type:"button"},"+",8,st)):r("",!0)]),t("th",et,a(e.total),1),t("th",null,[s.step===1?(o(),l("button",{key:0,onClick:d=>c.delCart(e.id),type:"button",class:"btn btn-primary"},rt,8,ot)):r("",!0)])]))),128))])])):r("",!0),s.step===3?(o(),l("table",nt,[ct,t("tbody",at,[t("div",dt,"NT$ "+a(s.orderTotal),1),(o(!0),l(_,null,k(c.orderItem,e=>(o(),l("tr",{key:e.id},[t("th",it,[t("img",{src:e.product.imageUrl,class:"me-2 toast-img",alt:e.product.imageUrl},null,8,pt)]),t("th",null,a(e.product.title),1),t("th",ut,a(e.product.price),1),t("th",_t,[s.step===1?(o(),l("button",{key:0,onClick:d=>{e.qty--,c.putCart(e.id,e.qty)},class:"btn fw-bold",type:"button",disabled:e.qty===1},"–",8,ht)):r("",!0),p(" "+a(e.qty)+" ",1),s.step===1?(o(),l("button",{key:1,onClick:d=>{e.qty++,c.putCart(e.id,e.qty)},class:"btn fw-bold",type:"button"},"+",8,yt)):r("",!0)]),t("th",bt,a(e.total),1),t("th",null,[s.step===1?(o(),l("button",{key:0,onClick:d=>c.delCart(e.id),type:"button",class:"btn btn-primary"},xt,8,gt)):r("",!0)])]))),128))])])):r("",!0),s.step===2||s.step===3?(o(),l("h3",kt,"訂餐人資料")):r("",!0),s.step===2||s.step===3?(o(),l("table",vt,[ft,t("tbody",Ct,[t("tr",null,[t("th",wt,[h(t("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>s.userData.data.user.name=e),type:"text",placeholder:"姓名",class:i(["bg-transparent py-2 text-center",{"border-0":s.step===3}]),disabled:s.step===3},null,10,Tt),[[y,s.userData.data.user.name]])]),t("th",It,[h(t("input",{"onUpdate:modelValue":n[1]||(n[1]=e=>s.userData.data.user.tel=e),type:"text",placeholder:"0911345678",class:i(["bg-transparent py-2 text-center",{"border-0":s.step===3}]),disabled:s.step===3},null,10,St),[[y,s.userData.data.user.tel]])]),t("th",Vt,[h(t("input",{"onUpdate:modelValue":n[2]||(n[2]=e=>s.userData.data.user.email=e),type:"text",placeholder:"abc@gmail.com",class:i(["bg-transparent py-2 text-center",{"border-0":s.step===3}]),disabled:s.step===3},null,10,qt),[[y,s.userData.data.user.email]])])])])])):r("",!0),s.step===2||s.step===3?(o(),l("h3",Dt,"付款方式")):r("",!0),s.step===2||s.step===3?(o(),l("select",{key:5,name:"",id:"",class:"bg-transparent p-2 mx-auto d-block",disabled:s.step===3},Lt,8,Ot)):r("",!0),s.step===1?(o(),l("a",{key:6,href:"javascript:;",class:"btn_reserve py-3 px-9 py-md-4 px-md-11 mx-auto mt-10 mb-8",onClick:n[3]||(n[3]=e=>u.nextStep(2))},"下一步")):r("",!0),s.step===2?(o(),l("a",{key:7,href:"javascript:;",class:"btn_reserve py-3 px-9 py-md-4 px-md-11 mx-auto mt-10 mb-8",onClick:n[4]||(n[4]=e=>u.handleOrderSubmit())},"送出訂單")):r("",!0),t("div",At,[s.step===3?(o(),v(b,{key:0,onClick:u.scrollTo,to:"/",class:"btn_reserve py-3 px-5 py-md-4 px-md-11 mx-auto mt-10 mb-8"},{default:f(()=>[p("回首頁")]),_:1},8,["onClick"])):r("",!0),s.step===3?(o(),v(b,{key:1,to:"/userorders",class:"btn_reserve py-3 px-5 py-md-4 px-md-11 mx-auto mt-10 mb-8"},{default:f(()=>[p("查看我的所有訂單")]),_:1})):r("",!0)])])],64)}const Mt=I(N,[["render",Pt]]);export{Mt as default};
