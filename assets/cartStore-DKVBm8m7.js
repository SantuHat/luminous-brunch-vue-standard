import{u as h,l as e}from"./index-DB9Op6xa.js";var d={VITE_API:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"luminous",BASE_URL:"/luminous-brunch-vue-standard/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:o,VITE_PATH:r}=d,u=h("cartStore",{state:()=>({carts:[],final_total:0,total:0,cart:{},status:{addCartLoading:""},cartUpdated:!1,isAreaLoading:!1,isLoading:!1}),actions:{addCart(t,a,s=1){this.status.addCartLoading=t,this.cart=a;const i=`${o}/api/${r}/cart`,n={data:{product_id:t,qty:s}};e.post(i,n).then(c=>{this.status.addCartLoading="",this.cart=c.data.data,this.cartUpdated=!0}).catch(c=>{console.log(c)})},async delCart(t){const{VITE_API:a,VITE_PATH:s}=d;try{this.carts.length>1&&(this.isAreaLoading=!0),await e.delete(`${a}api/${s}/cart/${t}`).catch(()=>{alert("刪除失敗")}),this.getCarts(),await new Promise(i=>setTimeout(i,300)),this.isAreaLoading=!1}catch(i){console.log(i),this.isAreaLoading=!1}},async getCarts(){(!this.isAreaLoading||this.carts.length===0)&&(this.isLoading=!0);try{const t=`${o}/api/${r}/cart`;await e.get(t).then(a=>{this.carts=a.data.data.carts,this.final_total=a.data.data.final_total,this.total=a.data.data.total}).catch(a=>{console.log(a)}),await new Promise(a=>setTimeout(a,300)),this.isLoading=!1}catch(t){console.log(t),this.isLoading=!1}},setCartUpdate(){this.cartUpdated=!1,this.getCarts()},getProduct(){const{id:t}=this.$route.params;this.$http.get(`${o}api/${r}/product/${t}`).then(a=>{this.product=a.data.product,this.matchCategory()}).catch(a=>{console.log(a)})},async putCart(t,a){try{this.isAreaLoading=!0;const s={data:{product_id:t,qty:a}};await e.put(`${o}api/${r}/cart/${t}`,s),this.getCarts(),await new Promise(i=>setTimeout(i,300)),this.isAreaLoading=!1}catch(s){console.log(s),this.isAreaLoading=!1}},setIsLoading(t){this.isLoading=t}},getters:{cartData:({carts:t})=>t,cartTotal:({total:t})=>t}});export{u as c};
